@{

Layout = "_GameLayout";
}
<!DOCTYPE html>
<html>
<head>
    <title>Game Tài Xỉu</title>
   
    <link rel="stylesheet" href="~/css/SicBo.css" asp-append-version="true" />


</head>
<body>
    <h2>Chào mừng đến với phòng: @ViewBag.RoomName</h2>
    <div class="main-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="user-card" id="user1">
                <h4>Bạn</h4>
                <p>Số dư: <span id="balance">$100</span></p>
            </div>
            <a href="/Home/Index">Thoát</a>
        </aside>

        <section class="game-section">
            <div class="dice-wrapper">
                <div class="containerD" id="dice1"></div>
                <div class="containerD" id="dice2"></div>
                <div class="containerD" id="dice3"></div>
            </div>

            <div id="latestResults" class="text-center">
                <h5>6 Lần Kết Quả Mới Nhất</h5>
                <div id="resultsContainer"></div>
            </div>

            <div class="prediction-buttons">
                <button class="predict-btn" data-value="xiu">Xỉu (4-10)</button>
                <button class="predict-btn" data-value="tai">Tài (11-17)</button>
            </div>

            <button class="btn" id="spinBtn">Lắc Xúc Xắc</button>
            <p id="resultText"></p>
            <p id="sumResult"></p>
        </section>
    </div>

    <script>
        const spinBtn = document.getElementById("spinBtn");
        const resultText = document.getElementById("resultText");
        const sumResult = document.getElementById("sumResult");
        const balanceText = document.getElementById("balance");
        const predictButtons = document.querySelectorAll(".predict-btn");
        const diceDivs = [document.getElementById("dice1"), document.getElementById("dice2"), document.getElementById("dice3")];
        const resultsContainer = document.getElementById("resultsContainer");

        let prediction = null;
        let balance = 100;
        let latestResults = [];

        predictButtons.forEach(btn => {
            btn.addEventListener("click", () => {
                prediction = btn.dataset.value;
                predictButtons.forEach(b => b.style.backgroundColor = "");
                btn.style.backgroundColor = "#8f8";
            });
        });

        function rollDice() {
            return Math.floor(Math.random() * 6) + 1;
        }

        function updateLatestResults(newResult) {
            latestResults.unshift(newResult);
            if (latestResults.length > 6) {
                latestResults.pop();
            }

            resultsContainer.innerHTML = "";

            latestResults.forEach(r => {
                const span = document.createElement("span");
                span.classList.add("result-badge");

                span.classList.add(r.result);

                if (r.result === 'hoa') {
                    span.classList.add("draw");
                } else if (r.prediction === r.result) {
                    span.classList.add("win");
                } else {
                    span.classList.add("lose");
                }

                span.textContent = `${r.sum} (${r.result.toUpperCase()})`;
                resultsContainer.appendChild(span);
            });
        }

        spinBtn.addEventListener("click", () => {
            if (!prediction) {
                resultText.textContent = "Vui lòng chọn Tài hoặc Xỉu để cược.";
                return;
            }

            const dice = [rollDice(), rollDice(), rollDice()];
            const sum = dice.reduce((a, b) => a + b, 0);

            // Hiển thị số xúc xắc
            diceDivs.forEach((div, i) => {
                div.textContent = `🎲 ${dice[i]}`;
            });

            sumResult.textContent = `Tổng: ${sum}`;

            const result = (sum >= 11 && sum <= 17) ? "tai" :
                (sum >= 4 && sum <= 10) ? "xiu" : "hoa";

            if (result === prediction) {
                resultText.textContent = "✅ You Won!";
                balance += 10;
            } else if (result === 'hoa') {
                resultText.textContent = "Draw!";
            } else {
                resultText.textContent = "❌ You Lost!";
                balance -= 10;
            }

            balanceText.textContent = `$${balance}`;

            updateLatestResults({ sum, result, prediction });
        });
    </script>
</body>

</html>

