@model LoginViewModel
@{
    ViewData["Title"] = "Login";
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"] - MyApp</title>

    <style>
        .form-container {
            max-width: 420px;
            margin: 5% auto;
            padding: 2rem;
            background: linear-gradient(145deg, #3b261a, #2e1a10);
            border: 3px double #b78d4c;
            border-radius: 1.2rem;
            box-shadow: 0 0 25px rgba(183, 141, 76, 0.2), 0 0 10px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(1px);
            position: relative;
            overflow: hidden;
        }

            .form-container::before {
                content: "";
                position: absolute;
                inset: 0;
                border-radius: 1.2rem;
                background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.05), transparent 70%);
                z-index: 0;
            }

        .nav-tabs .nav-link {
            font-family: 'Bebas Neue', cursive;
            font-size: 1.4rem;
            color: #f3c87a;
            background: transparent;
            border: none;
            text-shadow: 0 0 2px #b78d4c;
            transition: all 0.3s ease-in-out;
            position: relative;
        }

            .nav-tabs .nav-link::after {
                content: '';
                display: block;
                height: 2px;
                background: #f3c87a;
                transform: scaleX(0);
                transform-origin: left;
                transition: transform 0.3s ease;
            }

            .nav-tabs .nav-link:hover::after {
                transform: scaleX(1);
            }

            .nav-tabs .nav-link.active {
                background-color: #b85c38;
                color: #fff;
                border-radius: 0.5rem 0.5rem 0 0;
                text-shadow: none;
            }

        label {
            color: #f8e4c2;
            font-weight: 600;
            font-size: 0.95rem;
        }

        input.form-control {
            border-radius: 0.5rem;
            background-color: #fffdf8;
            border: 1px solid #b78d4c;
            color: #3b261a;
            font-size: 0.95rem;
            padding: 0.6rem;
        }

            input.form-control:focus {
                border-color: #d3a857;
                box-shadow: 0 0 0 0.25rem rgba(211, 168, 87, 0.25);
                outline: none;
            }

        .btn-primary:hover,
        .btn-success:hover {
            background-color: #6f3d2b;
            border-color: #6f3d2b;
            box-shadow: 0 0 12px rgba(183, 141, 76, 0.5);
        }

        .text-danger {
            color: #ff9980;
        }

        .tab-content {
            margin-top: 1.5rem;
            z-index: 1;
            position: relative;
        }
    </style>
</head>

<body>
    <div class="form-container">
        <ul class="nav nav-tabs mb-3" id="authTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="signin-tab" data-bs-toggle="tab" data-bs-target="#signin"
                        type="button" role="tab" aria-controls="signin" aria-selected="true">
                    Sign In
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="signup-tab" data-bs-toggle="tab" data-bs-target="#signup" type="button"
                        role="tab" aria-controls="signup" aria-selected="false">
                    Sign Up
                </button>
            </li>
        </ul>

        <div class="tab-content" id="authTabsContent">
            <!-- Sign In -->
            <div class="tab-pane fade show active" id="signin" role="tabpanel" aria-labelledby="signin-tab">
                <form asp-action="Login" asp-controller="Account" method="post" novalidate>
                    <div class="mb-3">
                        <label for="UserNameSignin" class="form-label">UserName</label>
                        <input type="text" id="UserNameSignin" name="UserName" class="form-control" required />
                        <span id="usernameStatusSignin" style="font-size:0.9rem;"></span>
                    </div>
                    <div class="mb-3">
                        <label for="EmailSignin" class="form-label">Email</label>
                        <input type="email" id="EmailSignin" name="Email" class="form-control" required />
                        <span id="emailStatusSignin" style="font-size:0.9rem;"></span>
                    </div>

                    <button type="submit" class="btn btn-primary w-100">Sign In</button>
                </form>
            </div>

            <!-- Sign Up -->
            <div class="tab-pane fade" id="signup" role="tabpanel" aria-labelledby="signup-tab">
                <form asp-action="Register" asp-controller="Account" method="post" novalidate>
                    <div class="mb-3">
                        <label for="UserNameSignUp" class="form-label">UserName</label>
                        <input type="text" id="UserNameSignUp" name="UserName" class="form-control" required />
                        <span id="usernameStatusSignUp" style="font-size:0.9rem;"></span>
                    </div>
                    <div class="mb-3">
                        <label for="EmailSignUp" class="form-label">Email</label>
                        <input type="email" id="EmailSignUp" name="Email" class="form-control" required />
                        <span id="emailStatusSignUp" style="font-size:0.9rem;"></span>
                    </div>
                    <div class="mb-3">
                        <label for="PasswordSignUp" class="form-label">Password</label>
                        <input type="password" id="PasswordSignUp" name="Password" class="form-control" required />
                    </div>
                    <div class="mb-3">
                        <label for="Phone" class="form-label">Phone Number</label>
                        <input type="tel" id="Phone" name="Phone" class="form-control" pattern="\d{10}"
                               placeholder="10-digit number" required />
                    </div>
                    <button type="submit" class="btn btn-success w-100">Sign Up</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        $(function () {
            // Username live check on Sign Up tab
            $('#UserNameSignUp').on('input', function () {
                const username = $(this).val().trim();
                if (username.length >= 3) {
                    $.getJSON('@Url.Action("CheckUsername", "Account")', { username }, function (data) {
                        if (data.exists) {
                            $('#usernameStatusSignUp').text('Username is already taken').css('color', 'red');
                        } else {
                            $('#usernameStatusSignUp').text('Username is available').css('color', 'green');
                        }
                    });
                } else {
                    $('#usernameStatusSignUp').text('');
                }
            });

            // Email live check on Sign Up tab
            $('#EmailSignUp').on('input', function () {
                const email = $(this).val().trim();
                if (email.length >= 5) {
                    $.getJSON('@Url.Action("CheckEmail", "Account")', { email }, function (data) {
                        if (data.exists) {
                            $('#emailStatusSignUp').text('Email is already in use').css('color', 'red');
                        } else {
                            $('#emailStatusSignUp').text('Email is available').css('color', 'green');
                        }
                    });
                } else {
                    $('#emailStatusSignUp').text('');
                }
            });

            // Optionally, you can also add live check on Sign In tab inputs, just update selectors and messages
            // But typically login doesn't need availability check
        });
    </script>

    <partial name="_ValidationScriptsPartial" />
</body>

</html>
